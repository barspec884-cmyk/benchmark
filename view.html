<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bar SPEC - AMBER PALETTE MAJORITY</title>
    <style>
        body { 
            display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; 
            background: #000; /* 背景を真っ黒にして高級感を出す */
            color: #eee; font-family: serif; 
        }
        .header-title {
            margin-top: 40px; color: #d4af37; font-size: 1.8em; letter-spacing: 8px; text-align: center;
        }
        .matrix-container { position: relative; margin: 40px auto; }
        .matrix-board { 
            position: relative; width: min(92vw, 500px); aspect-ratio: 1/1; 
            border: 1px solid #d4af37; background-color: #111; /* 背景を暗くしてグリッドを際立たせる */
            background-image: linear-gradient(rgba(212, 175, 55, 0.1) 1px, transparent 1px), 
                              linear-gradient(90deg, rgba(212, 175, 55, 0.1) 1px, transparent 1px);
            background-size: 10% 10%;
        }
        
        .axis-label { position: absolute; color: #d4af37; font-size: 10px; font-weight: bold; }
        .label-top { top: -25px; left: 50%; transform: translateX(-50%); }
        .label-bottom { bottom: -25px; left: 50%; transform: translateX(-50%); }
        .label-left { left: -45px; top: 50%; transform: translateY(-50%) rotate(-90deg); }
        .label-right { right: -45px; top: 50%; transform: translateY(-50%) rotate(90deg); }

        .bottle { 
            position: absolute; transform: translate(-50%, -50%); 
            display: flex; flex-direction: column; align-items: center; z-index: 10; 
        }
        .dot { 
            width: 8px; height: 8px; background: #fff; border-radius: 50%; 
            box-shadow: 0 0 10px #d4af37; margin-bottom: 2px;
        }
        .label { 
            background: rgba(212, 175, 55, 0.9); color: #000; font-size: 9px; 
            padding: 1px 5px; border-radius: 2px; white-space: nowrap; font-weight: bold;
        }

        /* 基準点（センター）のデザイン */
        .benchmark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; opacity: 0.7; }
        .benchmark img { width: 30px; filter: grayscale(1); }
        .benchmark span { display: block; font-size: 9px; color: #777; }
    </style>
</head>
<body>
    <div class="header-title">AMBER MAP</div>
    <div class="matrix-container">
        <div class="axis-label label-top">SMOKY</div><div class="axis-label label-bottom">DELICATE</div>
        <div class="axis-label label-left">LIGHT</div><div class="axis-label label-right">RICH</div>
        <div class="matrix-board" id="board">
            <div class="benchmark">
                <img src="bottle_image.webp" alt="center">
                <span>CENTER</span>
            </div>
        </div>
    </div>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbxOyZZfvdOWhTfdjVlNBkDk6axBYHb6RoZU9MSGG8dlo58CU46NUfAjY1BF_-6LZAEFog/exec";

        async function loadData() {
            const board = document.getElementById('board');
            try {
                const response = await fetch(GAS_URL);
                const data = await response.json();
                render(data);
            } catch (e) {
                console.error("データ取得エラー", e);
            }
        }

        function render(data) {
            const board = document.getElementById('board');
            // 十字線のみ追加（既存のベンチマークは残す）
            board.innerHTML += `
                <div style="position:absolute; width:100%; height:1px; top:50%; left:0; background:rgba(212,175,55,0.2);"></div>
                <div style="position:absolute; height:100%; width:1px; left:50%; top:0; background:rgba(212,175,55,0.2);"></div>
            `;
            
            data.forEach(item => {
                // 条件を「山崎 NAS」に一致させる
                if (item.brand === "山崎 NAS" && item.role === "調査") {
                    const bottleEl = document.createElement('div');
                    bottleEl.className = 'bottle';
                    bottleEl.style.left = (50 + Number(item.rich)) + '%';
                    bottleEl.style.top = (50 - Number(item.smoky)) + '%';
                    bottleEl.innerHTML = `<div class="dot"></div><span class="label">${item.user}</span>`;
                    board.appendChild(bottleEl);
                }
            });
        }
        window.onload = loadData;
    </script>
</body>
</html>